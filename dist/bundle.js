(()=>{"use strict";async function e(e,t={}){const o=localStorage.getItem("token"),n={...t.headers,...o&&{Authorization:`Bearer ${o}`}};try{console.log("Fetching token",e);const o=await fetch(e,{...t,headers:n});if(console.log("Raw Response:",o),!o.ok){const e=await o.json();throw new Error(e.message||`HTTP error ! status : ${o.status}`)}const a=await o.json();return console.log("Parsed JSON Response:",a),a}catch(e){throw console.error(e),e}}const t="https://notes-api.dicoding.dev/v2";function o(){return new Promise((e=>{const t=document.createElement("div");t.id="loading-indicator",t.textContent="Loading...",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.padding="20px",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.color="white",t.style.borderRadius="5px",t.style.zIndex="1000",document.body.appendChild(t),setTimeout((()=>{e()}),3e3)}))}function n(){const e=document.getElementById("loading-indicator");e&&e.remove()}document.addEventListener("DOMContentLoaded",(()=>{const a=document.getElementById("notes-list");async function s(){await o();try{const o=await async function(){try{return await e(`${t}/notes`)}catch(e){throw console.error("Error fetching all notes:",e),e}}();console.log("Response FROM getAllNotes",o);const{status:n,message:s,data:r}=o;if("success"!==n)throw new Error(s||"Failed to fetch notes");a.innerHTML="",r.forEach((e=>{const t=document.createElement("li");t.classList.add("note-item"),t.innerHTML=`\n          <h3>${e.title}</h3>\n          <p>${e.body}</p>\n          <button class="delete-button" data-id="${e.id}">Delete</button>\n        `,a.appendChild(t)}))}catch(e){alert(`Failed to fetch notes: ${e.message}`)}finally{n()}}document.getElementById("add-note-form").addEventListener("submit",(async a=>{a.preventDefault(),console.log("Submit event triggered (single check)");const r=document.getElementById("title"),c=document.getElementById("body"),i=r.value.trim(),l=c.value.trim();if(i&&l){await o(),console.log("Before createNote()");try{const o=await async function(o,n){try{return await e(`${t}/notes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:o,body:n})})}catch(e){throw console.error("Error creating note:",e),e}}(i,l),{status:n,message:a,data:d}=o;if(console.log("After createNote()",o),"success"!==n)throw new Error(a||"Failed to add note");r.value="",c.value="",await s(),console.log("After renderNotes()")}catch(e){alert(`Failed to add note: ${e.message}`)}finally{n()}}else alert("Title and body cannot be empty.")})),a.addEventListener("click",(async a=>{if(a.target.classList.contains("delete-button")){const r=a.target.dataset.id;if(confirm("Are you sure you want to delete this note?")){await o();try{const o=await async function(o){return e(`${t}/notes/${o}`,{method:"DELETE"})}(r),{status:n,message:a}=o;if("success"!==n)throw new Error(a||"Failed to delete note");await s(),console.log("renderNotes() called after delete")}catch(e){alert(`Failed to delete note: ${e.message}`)}finally{n()}}}})),s()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQ0YsQ0FDRixDQUNGLEtBR0ZLLEdBQWEsRyIsInNvdXJjZXMiOlsid2VicGFjazovL25vdGVzYXBwX3dpdGhhcGkvLi9zcmMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vbm90ZXNhcHBfd2l0aGFwaS8uL3NyYy9iYXNlX3VybC5qcyIsIndlYnBhY2s6Ly9ub3Rlc2FwcF93aXRoYXBpLy4vc3JjL2xvYWRpbmcuanMiLCJ3ZWJwYWNrOi8vbm90ZXNhcHBfd2l0aGFwaS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9ub3Rlc2FwcF93aXRoYXBpLy4vc3JjL25vdGVzLWFwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hUb2tlbih1cmwsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidG9rZW5cIik7XG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgLi4ub3B0aW9ucy5oZWFkZXJzLFxuICAgIC4uLih0b2tlbiAmJiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gIH0pLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJGZXRjaGluZyB0b2tlblwiLCB1cmwpO1xuICAgIGNvbnN0IEFwaVJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IC4uLm9wdGlvbnMsIGhlYWRlcnMgfSk7XG4gICAgY29uc29sZS5sb2coXCJSYXcgUmVzcG9uc2U6XCIsIEFwaVJlc3BvbnNlKTtcbiAgICBpZiAoIUFwaVJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCBBcGlSZXNwb25zZS5qc29uKCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGVycm9yRGF0YS5tZXNzYWdlIHx8IGBIVFRQIGVycm9yICEgc3RhdHVzIDogJHtBcGlSZXNwb25zZS5zdGF0dXN9YCxcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGpzb25EYXRhID0gYXdhaXQgQXBpUmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKFwiUGFyc2VkIEpTT04gUmVzcG9uc2U6XCIsIGpzb25EYXRhKTtcbiAgICByZXR1cm4ganNvbkRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBCQVNFX1VSTCA9IFwiaHR0cHM6Ly9ub3Rlcy1hcGkuZGljb2RpbmcuZGV2L3YyXCI7XG4iLCIvLyBzcmMvbG9hZGluZy5qc1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dMb2FkaW5nKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSAgPT57XG4gIGNvbnN0IGxvYWRpbmdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgbG9hZGluZ0VsZW1lbnQuaWQgPSBcImxvYWRpbmctaW5kaWNhdG9yXCI7XG4gIGxvYWRpbmdFbGVtZW50LnRleHRDb250ZW50ID0gXCJMb2FkaW5nLi4uXCI7XG4gIC8vIFRhbWJhaGthbiBzdHlsaW5nIHVudHVrIGluZGlrYXRvciBsb2FkaW5nIGRpIHNpbmkgYXRhdSBtZWxhbHVpIENTUyB0ZXJwaXNhaFxuICBsb2FkaW5nRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcbiAgbG9hZGluZ0VsZW1lbnQuc3R5bGUudG9wID0gXCI1MCVcIjtcbiAgbG9hZGluZ0VsZW1lbnQuc3R5bGUubGVmdCA9IFwiNTAlXCI7XG4gIGxvYWRpbmdFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUsIC01MCUpXCI7XG4gIGxvYWRpbmdFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSBcIjIwcHhcIjtcbiAgbG9hZGluZ0VsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZ2JhKDAsIDAsIDAsIDAuNSlcIjtcbiAgbG9hZGluZ0VsZW1lbnQuc3R5bGUuY29sb3IgPSBcIndoaXRlXCI7XG4gIGxvYWRpbmdFbGVtZW50LnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiNXB4XCI7XG4gIGxvYWRpbmdFbGVtZW50LnN0eWxlLnpJbmRleCA9IFwiMTAwMFwiO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxvYWRpbmdFbGVtZW50KTtcblxuICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgcmVzb2x2ZSgpO1xuICB9LCAzMDAwKTtcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhpZGVMb2FkaW5nKCkge1xuICBjb25zdCBsb2FkaW5nRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGlmIChsb2FkaW5nRWxlbWVudCkge1xuICAgIGxvYWRpbmdFbGVtZW50LnJlbW92ZSgpO1xuICB9XG59XG4iLCIvLyBzcmMvaW5kZXguanNcbmltcG9ydCB7IGdldEFsbE5vdGVzLCBjcmVhdGVOb3RlLCBkZWxldGVOb3RlIH0gZnJvbSBcIi4vbm90ZXMtYXBpLmpzXCI7XG5pbXBvcnQgeyBzaG93TG9hZGluZywgaGlkZUxvYWRpbmcgfSBmcm9tIFwiLi9sb2FkaW5nLmpzXCI7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgY29uc3Qgbm90ZUxpc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub3Rlcy1saXN0XCIpO1xuICBjb25zdCBhZGROb3RlRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLW5vdGUtZm9ybVwiKTtcblxuICBhc3luYyBmdW5jdGlvbiByZW5kZXJOb3RlcygpIHtcbiAgICBhd2FpdCBzaG93TG9hZGluZygpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEFsbE5vdGVzKCk7XG4gICAgICBjb25zb2xlLmxvZyhcIlJlc3BvbnNlIEZST00gZ2V0QWxsTm90ZXNcIiwgcmVzcG9uc2UpO1xuICAgICAgY29uc3QgeyBzdGF0dXMsIG1lc3NhZ2UsIGRhdGEgfSA9IHJlc3BvbnNlO1xuXG4gICAgICBpZiAoc3RhdHVzICE9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSB8fCBcIkZhaWxlZCB0byBmZXRjaCBub3Rlc1wiKTtcbiAgICAgIH1cblxuICAgICAgbm90ZUxpc3RFbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG4gICAgICBkYXRhLmZvckVhY2goKG5vdGUpID0+IHtcbiAgICAgICAgY29uc3QgbGlzdEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgICAgIGxpc3RJdGVtLmNsYXNzTGlzdC5hZGQoXCJub3RlLWl0ZW1cIik7XG4gICAgICAgIGxpc3RJdGVtLmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8aDM+JHtub3RlLnRpdGxlfTwvaDM+XG4gICAgICAgICAgPHA+JHtub3RlLmJvZHl9PC9wPlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJkZWxldGUtYnV0dG9uXCIgZGF0YS1pZD1cIiR7bm90ZS5pZH1cIj5EZWxldGU8L2J1dHRvbj5cbiAgICAgICAgYDtcbiAgICAgICAgbm90ZUxpc3RFbGVtZW50LmFwcGVuZENoaWxkKGxpc3RJdGVtKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBhbGVydChgRmFpbGVkIHRvIGZldGNoIG5vdGVzOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgfVxuICB9XG5cbiAgYWRkTm90ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnNvbGUubG9nKFwiU3VibWl0IGV2ZW50IHRyaWdnZXJlZCAoc2luZ2xlIGNoZWNrKVwiKTtcbiAgICBjb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aXRsZVwiKTtcbiAgICBjb25zdCBib2R5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJvZHlcIik7XG4gICAgY29uc3QgdGl0bGUgPSB0aXRsZUlucHV0LnZhbHVlLnRyaW0oKTtcbiAgICBjb25zdCBib2R5ID0gYm9keUlucHV0LnZhbHVlLnRyaW0oKTtcblxuICAgIGlmICh0aXRsZSAmJiBib2R5KSB7XG4gICAgICBhd2FpdCBzaG93TG9hZGluZygpO1xuXG4gICAgICBjb25zb2xlLmxvZyhcIkJlZm9yZSBjcmVhdGVOb3RlKClcIik7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNyZWF0ZU5vdGUodGl0bGUsIGJvZHkpO1xuICAgICAgICBjb25zdCB7IHN0YXR1cywgbWVzc2FnZSwgZGF0YSB9ID0gcmVzcG9uc2U7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQWZ0ZXIgY3JlYXRlTm90ZSgpXCIsIHJlc3BvbnNlKTtcblxuICAgICAgICBpZiAoc3RhdHVzICE9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlIHx8IFwiRmFpbGVkIHRvIGFkZCBub3RlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRpdGxlSW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBib2R5SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBhd2FpdCByZW5kZXJOb3RlcygpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQWZ0ZXIgcmVuZGVyTm90ZXMoKVwiKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KGBGYWlsZWQgdG8gYWRkIG5vdGU6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KFwiVGl0bGUgYW5kIGJvZHkgY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIG5vdGVMaXN0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJkZWxldGUtYnV0dG9uXCIpKSB7XG4gICAgICBjb25zdCBub3RlSWQgPSBldmVudC50YXJnZXQuZGF0YXNldC5pZDtcbiAgICAgIGlmIChjb25maXJtKFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIG5vdGU/XCIpKSB7XG4gICAgICAgIGF3YWl0IHNob3dMb2FkaW5nKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBkZWxldGVOb3RlKG5vdGVJZCk7XG4gICAgICAgICAgY29uc3QgeyBzdGF0dXMsIG1lc3NhZ2UgfSA9IHJlc3BvbnNlO1xuXG4gICAgICAgICAgaWYgKHN0YXR1cyAhPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlIHx8IFwiRmFpbGVkIHRvIGRlbGV0ZSBub3RlXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGF3YWl0IHJlbmRlck5vdGVzKCk7XG5cbiAgICAgICAgICBjb25zb2xlLmxvZyhcInJlbmRlck5vdGVzKCkgY2FsbGVkIGFmdGVyIGRlbGV0ZVwiKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBhbGVydChgRmFpbGVkIHRvIGRlbGV0ZSBub3RlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmVuZGVyTm90ZXMoKTsgLy8gTG9hZCBub3RlcyBvbiBwYWdlIGxvYWRcbn0pO1xuIiwiaW1wb3J0IHsgZmV0Y2hUb2tlbiB9IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQgeyBCQVNFX1VSTCB9IGZyb20gXCIuL2Jhc2VfdXJsXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVOb3RlKHRpdGxlLCBib2R5KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgQWRkUmVzcG9uc2UgPSBhd2FpdCBmZXRjaFRva2VuKGAke0JBU0VfVVJMfS9ub3Rlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgdGl0bGU6IHRpdGxlLCBib2R5OiBib2R5IH0pLCAvLyBQYXN0aWthbiBpbmkgYWRhbGFoIG9iamVrXG4gICAgfSk7XG4gICAgcmV0dXJuIEFkZFJlc3BvbnNlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBub3RlOlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbE5vdGVzKCkge1xuICB0cnkge1xuICAgIGNvbnN0IE5vdGVzUmVzcG9uc2UgPSBhd2FpdCBmZXRjaFRva2VuKGAke0JBU0VfVVJMfS9ub3Rlc2ApO1xuICAgIHJldHVybiBOb3Rlc1Jlc3BvbnNlOyAvLyBQYXN0aWthbiBtZW5nZW1iYWxpa2FuIHNlbHVydWggb2JqZWsgcmVzcG9uc1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBhbGwgbm90ZXM6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Tm90ZUJ5SWQoaWQpIHtcbiAgcmV0dXJuIGZldGNoVG9rZW4oYCR7QkFTRV9VUkx9L25vdGVzLyR7aWR9YCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVOb3RlKGlkKSB7XG4gIHJldHVybiBmZXRjaFRva2VuKGAke0JBU0VfVVJMfS9ub3Rlcy8ke2lkfWAsIHtcbiAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXJjaGl2ZU5vdGUoaWQpIHtcbiAgcmV0dXJuIGZldGNoVG9rZW4oYCR7QkFTRV9VUkx9L25vdGVzLyR7aWR9L2FyY2hpdmVgLCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmFyY2hpdmVOb3RlKGlkKSB7XG4gIHJldHVybiBmZXRjaFRva2VuKGAke0JBU0VfVVJMfS9ub3Rlcy8ke2lkfS91bmFyY2hpdmVgLCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiYXN5bmMiLCJ1cmwiLCJvcHRpb25zIiwidG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJjb25zb2xlIiwibG9nIiwiQXBpUmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiZXJyb3JEYXRhIiwianNvbiIsIkVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsImpzb25EYXRhIiwiZXJyb3IiLCJzaG93TG9hZGluZyIsIlByb21pc2UiLCJyZXNvbHZlIiwibG9hZGluZ0VsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50Iiwic3R5bGUiLCJwb3NpdGlvbiIsInRvcCIsImxlZnQiLCJ0cmFuc2Zvcm0iLCJwYWRkaW5nIiwiYmFja2dyb3VuZENvbG9yIiwiY29sb3IiLCJib3JkZXJSYWRpdXMiLCJ6SW5kZXgiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJzZXRUaW1lb3V0IiwiaGlkZUxvYWRpbmciLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJub3RlTGlzdEVsZW1lbnQiLCJyZW5kZXJOb3RlcyIsInJlc3BvbnNlIiwiZ2V0QWxsTm90ZXMiLCJkYXRhIiwiaW5uZXJIVE1MIiwiZm9yRWFjaCIsIm5vdGUiLCJsaXN0SXRlbSIsImNsYXNzTGlzdCIsImFkZCIsInRpdGxlIiwiYWxlcnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidGl0bGVJbnB1dCIsImJvZHlJbnB1dCIsInZhbHVlIiwidHJpbSIsIm1ldGhvZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVOb3RlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJub3RlSWQiLCJkYXRhc2V0IiwiY29uZmlybSIsImRlbGV0ZU5vdGUiXSwic291cmNlUm9vdCI6IiJ9